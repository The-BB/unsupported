From a0e13b27c7982f2adb028a9162a4138044f9ac1e Mon Sep 17 00:00:00 2001
From: GammaC0de <gammac0de@users.noreply.github.com>
Date: Fri, 14 May 2021 12:36:59 +0300
Subject: [PATCH 027/150] [UptoboxCom] sync with stable

---
 src/pyload/plugins/accounts/UptoboxCom.py    | 11 +++++++----
 src/pyload/plugins/downloaders/UptoboxCom.py |  2 +-
 2 files changed, 8 insertions(+), 5 deletions(-)

--- a/src/pyload/plugins/accounts/UptoboxCom.py
+++ b/src/pyload/plugins/accounts/UptoboxCom.py
@@ -8,7 +8,7 @@ from ..base.xfs_account import XFSAccoun
 class UptoboxCom(XFSAccount):
     __name__ = "UptoboxCom"
     __type__ = "account"
-    __version__ = "0.23"
+    __version__ = "0.25"
     __status__ = "testing"
 
     __description__ = """Uptobox.com account plugin"""
@@ -19,9 +19,12 @@ class UptoboxCom(XFSAccount):
     ]
 
     PLUGIN_DOMAIN = "uptobox.com"
-    PLUGIN_URL = "https://uptobox.com/"
+
+    LOGIN_URL = "https://uptobox.com/login"
+    LOGIN_SKIP_PATTERN = r"https://uptobox\.com/logout"
 
     PREMIUM_PATTERN = r"Premium member"
+
     VALID_UNTIL_PATTERN = r"class='expiration-date .+?'>(\d{1,2} [\w^_]+ \d{4})"
 
     def signin(self, user, password, data):
@@ -31,9 +34,9 @@ class UptoboxCom(XFSAccount):
             self.skip_login()
 
         html = self.load(
-            self.PLUGIN_URL,
-            get={"op": "login", "referer": "homepage"},
+            self.LOGIN_URL,
             post={"login": user, "password": password},
+            ref=self.LOGIN_URL,
             cookies=self.COOKIES,
         )
 
--- a/src/pyload/plugins/downloaders/UptoboxCom.py
+++ b/src/pyload/plugins/downloaders/UptoboxCom.py
@@ -8,7 +8,7 @@ from ..base.simple_downloader import Sim
 class UptoboxCom(SimpleDownloader):
     __name__ = "UptoboxCom"
     __type__ = "downloader"
-    __version__ = "0.37"
+    __version__ = "0.38"
     __status__ = "testing"
 
     __pattern__ = r"https?://(?:www\.)?(uptobox|uptostream)\.com/\w{12}"
