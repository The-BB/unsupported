From d828d0ee040ea8a91031588ab5194f85922c4c71 Mon Sep 17 00:00:00 2001
From: GammaC0de <gammac0de@users.noreply.github.com>
Date: Tue, 27 Jul 2021 01:03:08 +0300
Subject: [PATCH 127/150] [WebshareCz] fix #3996

---
 src/pyload/plugins/accounts/WebshareCz.py | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)

--- a/src/pyload/plugins/accounts/WebshareCz.py
+++ b/src/pyload/plugins/accounts/WebshareCz.py
@@ -7,6 +7,11 @@ from pyload.core.network.request_factory
 
 from ..base.account import BaseAccount
 
+try:
+    import passlib.hash
+except ImportError:
+    pass
+
 
 class WebshareCz(BaseAccount):
     __name__ = "WebshareCz"
@@ -58,10 +63,7 @@ class WebshareCz(BaseAccount):
         salt = re.search("<salt>(.*?)</salt>", salt).group(1)
         salt_pw = salt + password
 
-        password = hashlib.sha1(
-            hashlib.md5(salt_pw.encode()).hexdigest().encode()
-        ).hexdigest()
-        digest = hashlib.md5(user + ":Webshare:" + password).hexdigest()
+        password = hashlib.sha1(passlib.hash.md5_crypt.encrypt(password, salt=salt).encode()).hexdigest()
 
         login = self.api_request(
             "login",
