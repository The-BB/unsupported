From 312a952005e241e9f0c66467ccb486cf23bdbd18 Mon Sep 17 00:00:00 2001
From: GammaC0de <gammac0de@users.noreply.github.com>
Date: Mon, 13 Sep 2021 23:06:31 +0300
Subject: [PATCH 143/150] update parse.name()

---
 src/pyload/core/utils/web/parse.py | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

--- a/src/pyload/core/utils/web/parse.py
+++ b/src/pyload/core/utils/web/parse.py
@@ -108,11 +108,13 @@ from ..purge import name as safe_nm
 
 def name(url, safe_name=True):
     url = format.url(url)
-    up = urllib.parse.urlparse(url, allow_fragments=False)
+    up = urllib.parse.urlparse(url)
     name = up.path.split("/")[-1]
     if not name:
         name = up.query.split("=", 1)[::-1][0].split("&", 1)[0]
-    if not name:
+    if not name and up.fragment:
+        name = "#" + up.fragment
+    else:
         name = up.netloc.split(".", 1)[0]
 
     return safe_nm(name) if safe_name else name
