From 1073d96f6744a593d663b9f4d1c10495a40ba05a Mon Sep 17 00:00:00 2001
From: GammaC0de <gammac0de@users.noreply.github.com>
Date: Sat, 13 Nov 2021 23:49:06 +0200
Subject: [PATCH 10/73] [New downloader] HotlinkCc (fix #4031)

---
 src/pyload/plugins/downloaders/HotlinkCc.py | 44 +++++++++++++++++++++
 1 file changed, 44 insertions(+)
 create mode 100644 src/pyload/plugins/downloaders/HotlinkCc.py

diff --git a/src/pyload/plugins/downloaders/HotlinkCc.py b/src/pyload/plugins/downloaders/HotlinkCc.py
new file mode 100644
index 000000000..71db93be8
--- /dev/null
+++ b/src/pyload/plugins/downloaders/HotlinkCc.py
@@ -0,0 +1,44 @@
+# -*- coding: utf-8 -*-
+
+import re
+
+from ..base.simple_downloader import SimpleDownloader
+
+
+class HotlinkCc(SimpleDownloader):
+    __name__ = "HotlinkCc"
+    __type__ = "hoster"
+    __version__ = "0.01"
+    __status__ = "testing"
+
+    __pattern__ = r"https?://hotlink\.cc/\w+"
+    __config__ = [
+        ("enabled", "bool", "Activated", True),
+        ("use_premium", "bool", "Use premium account if available", True),
+        ("fallback", "bool", "Fallback to free download if premium fails", True),
+        ("chk_filesize", "bool", "Check file size", True),
+        ("max_wait", "int", "Reconnect if waiting time is greater than minutes", 10),
+    ]
+
+    __description__ = """Hotlink.cc downloader plugin"""
+    __license__ = "GPLv3"
+    __authors__ = [("GammaC0de", "nitzo2001[AT]yahoo[DOT]com")]
+
+    NAME_PATTERN = r'<i class="glyphicon glyphicon-download"></i>\s*(?P<N>.+?)<'
+    SIZE_PATTERN = r"Filesize <b>(?P<S>[\d.,]+) (?P<U>[\w^_]+)<"
+
+    WAIT_PATTERN = r'<span class="seconds yellow"><b>(\d+)<'
+    DL_LIMIT_PATTERN = r"You have to wait (.+?) untill the next download"
+
+    OFFLINE_PATTERN = r">File Not Found</"
+
+    LINK_FREE_PATTERN = r'<a href="(https?://fs\d+.hotlink.cc/.+?)"'
+
+    def handle_free(self, pyfile):
+        url, inputs = self.parse_html_form('name="F1"')
+        if inputs is not None:
+            self.data = self.load(pyfile.url, post=inputs)
+
+            m = re.search(self.LINK_FREE_PATTERN, self.data)
+            if m is not None:
+                self.link = m.group(1)
-- 
2.30.2

