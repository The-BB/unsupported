From 4cf689ee94ec92de435923b167b5f8635f4a4260 Mon Sep 17 00:00:00 2001
From: GammaC0de <gammac0de@users.noreply.github.com>
Date: Wed, 24 Nov 2021 00:02:23 +0200
Subject: [PATCH 25/73] [ReCaptcha] now return result only

---
 src/pyload/plugins/accounts/FileboomMe.py       | 4 ++--
 src/pyload/plugins/accounts/Keep2ShareCc.py     | 4 ++--
 src/pyload/plugins/accounts/UploadgigCom.py     | 4 ++--
 src/pyload/plugins/addons/CloudFlareDdos.py     | 4 ++--
 src/pyload/plugins/anticaptchas/ReCaptcha.py    | 6 +++---
 src/pyload/plugins/base/xfs_downloader.py       | 4 ++--
 src/pyload/plugins/decrypters/CriptTo.py        | 4 ++--
 src/pyload/plugins/decrypters/FilecryptCc.py    | 4 ++--
 src/pyload/plugins/downloaders/FilecloudIo.py   | 4 ++--
 src/pyload/plugins/downloaders/FilefoxCc.py     | 4 ++--
 src/pyload/plugins/downloaders/FilejokerNet.py  | 4 ++--
 src/pyload/plugins/downloaders/FilerNet.py      | 4 ++--
 src/pyload/plugins/downloaders/HitfileNet.py    | 4 ++--
 src/pyload/plugins/downloaders/MediafireCom.py  | 4 ++--
 src/pyload/plugins/downloaders/NitroflareCom.py | 4 ++--
 src/pyload/plugins/downloaders/RapidgatorNet.py | 6 +++---
 src/pyload/plugins/downloaders/TurbobitNet.py   | 4 ++--
 src/pyload/plugins/downloaders/UlozTo.py        | 4 ++--
 src/pyload/plugins/downloaders/UploadedTo.py    | 4 ++--
 src/pyload/plugins/downloaders/UploadgigCom.py  | 4 ++--
 20 files changed, 42 insertions(+), 42 deletions(-)

diff --git a/src/pyload/plugins/accounts/FileboomMe.py b/src/pyload/plugins/accounts/FileboomMe.py
index 7fce3aa14..f6eda365e 100644
--- a/src/pyload/plugins/accounts/FileboomMe.py
+++ b/src/pyload/plugins/accounts/FileboomMe.py
@@ -15,7 +15,7 @@ from ..base.captcha import BaseCaptcha
 class FileboomMe(BaseAccount):
     __name__ = "FileboomMe"
     __type__ = "account"
-    __version__ = "0.02"
+    __version__ = "0.03"
     __status__ = "testing"
 
     __description__ = """Fileboom.me account plugin"""
@@ -73,7 +73,7 @@ class FileboomMe(BaseAccount):
                             self.log_error(_("Request reCAPTCHA API failed"))
                             self.fail_login(_("Request reCAPTCHA API failed"))
 
-                        re_captcha_response, _ = self.captcha.challenge(self.RECAPTCHA_KEY, version="2js", secure_token=False)
+                        re_captcha_response = self.captcha.challenge(self.RECAPTCHA_KEY, version="2js", secure_token=False)
                         try:
                             json_data = self.api_request("login",
                                                           username=user,
diff --git a/src/pyload/plugins/accounts/Keep2ShareCc.py b/src/pyload/plugins/accounts/Keep2ShareCc.py
index b993a3b08..384f581d7 100644
--- a/src/pyload/plugins/accounts/Keep2ShareCc.py
+++ b/src/pyload/plugins/accounts/Keep2ShareCc.py
@@ -15,7 +15,7 @@ from ..base.captcha import BaseCaptcha
 class Keep2ShareCc(BaseAccount):
     __name__ = "Keep2ShareCc"
     __type__ = "account"
-    __version__ = "0.17"
+    __version__ = "0.18"
     __status__ = "testing"
 
     __description__ = """Keep2Share.cc account plugin"""
@@ -92,7 +92,7 @@ class Keep2ShareCc(BaseAccount):
                             self.log_error(_("Request reCAPTCHA API failed"))
                             self.fail_login(_("Request reCAPTCHA API failed"))
 
-                        re_captcha_response, _ = self.captcha.challenge(
+                        re_captcha_response = self.captcha.challenge(
                             self.RECAPTCHA_KEY, version="2js", secure_token=False
                         )
                         try:
diff --git a/src/pyload/plugins/accounts/UploadgigCom.py b/src/pyload/plugins/accounts/UploadgigCom.py
index 063e6b508..0e2b8f926 100644
--- a/src/pyload/plugins/accounts/UploadgigCom.py
+++ b/src/pyload/plugins/accounts/UploadgigCom.py
@@ -14,7 +14,7 @@ from ..helpers import parse_html_form
 class UploadgigCom(BaseAccount):
     __name__ = "UploadgigCom"
     __type__ = "account"
-    __version__ = "0.05"
+    __version__ = "0.06"
     __status__ = "testing"
 
     __description__ = """UploadgigCom account plugin"""
@@ -89,7 +89,7 @@ class UploadgigCom(BaseAccount):
 
             if captcha_key:
                 self.captcha = recaptcha
-                response, _ = recaptcha.challenge(captcha_key, html)
+                response = recaptcha.challenge(captcha_key, html)
                 inputs["g-recaptcha-response"] = response
 
             else:
diff --git a/src/pyload/plugins/addons/CloudFlareDdos.py b/src/pyload/plugins/addons/CloudFlareDdos.py
index b0db2784a..0dea68f3f 100644
--- a/src/pyload/plugins/addons/CloudFlareDdos.py
+++ b/src/pyload/plugins/addons/CloudFlareDdos.py
@@ -197,7 +197,7 @@ class CloudFlare:
                     addon_plugin._("Detected CloudFlare's security check page")
                 )
 
-                response, challenge = captcha.challenge(captcha_key, data)
+                response = captcha.challenge(captcha_key, data)
                 return owner_plugin.load(
                     owner_plugin.fixurl("/cdn-cgi/l/chk_captcha"),
                     get={"g-recaptcha-response": response},
@@ -239,7 +239,7 @@ class PreloadStub:
 class CloudFlareDdos(BaseAddon):
     __name__ = "CloudFlareDdos"
     __type__ = "addon"
-    __version__ = "0.16"
+    __version__ = "0.17"
     __status__ = "testing"
 
     __config__ = [("enabled", "bool", "Activated", False)]
diff --git a/src/pyload/plugins/anticaptchas/ReCaptcha.py b/src/pyload/plugins/anticaptchas/ReCaptcha.py
index 4ea833006..5296ba757 100644
--- a/src/pyload/plugins/anticaptchas/ReCaptcha.py
+++ b/src/pyload/plugins/anticaptchas/ReCaptcha.py
@@ -16,7 +16,7 @@ from ..base.captcha_service import CaptchaService
 class ReCaptcha(CaptchaService):
     __name__ = "ReCaptcha"
     __type__ = "anticaptcha"
-    __version__ = '0.44'
+    __version__ = '0.45'
     __status__ = "testing"
 
     __description__ = "ReCaptcha captcha service plugin"
@@ -366,7 +366,7 @@ class ReCaptcha(CaptchaService):
         else:
             self.fail(self._("reCAPTCHA max retries exceeded"))
 
-        return result, challenge
+        return result
 
     # solve interactive captcha (javascript required), use when non-JS captcha
     # fallback for v2 is not allowed
@@ -385,7 +385,7 @@ class ReCaptcha(CaptchaService):
 
         result = self.decrypt_interactive(params, timeout=300)
 
-        return result, result
+        return result
 
 
 if __name__ == "__main__":
diff --git a/src/pyload/plugins/base/xfs_downloader.py b/src/pyload/plugins/base/xfs_downloader.py
index 1238c2f5a..53301da0f 100644
--- a/src/pyload/plugins/base/xfs_downloader.py
+++ b/src/pyload/plugins/base/xfs_downloader.py
@@ -18,7 +18,7 @@ from .simple_downloader import SimpleDownloader
 class XFSDownloader(SimpleDownloader):
     __name__ = "XFSDownloader"
     __type__ = "downloader"
-    __version__ = "0.85"
+    __version__ = "0.86"
     __status__ = "stable"
 
     __pattern__ = r"^unmatchable$"
@@ -229,7 +229,7 @@ class XFSDownloader(SimpleDownloader):
 
         if captcha_key:
             self.captcha = recaptcha
-            inputs["g-recaptcha-response"], _ = recaptcha.challenge(captcha_key)
+            inputs["g-recaptcha-response"] = recaptcha.challenge(captcha_key)
             return
 
         solvemedia = SolveMedia(self.pyfile)
diff --git a/src/pyload/plugins/decrypters/CriptTo.py b/src/pyload/plugins/decrypters/CriptTo.py
index 5860e74d3..339b0f3db 100644
--- a/src/pyload/plugins/decrypters/CriptTo.py
+++ b/src/pyload/plugins/decrypters/CriptTo.py
@@ -20,7 +20,7 @@ from ..base.simple_decrypter import SimpleDecrypter
 class CriptTo(SimpleDecrypter):
     __name__ = "CriptTo"
     __type__ = "decrypter"
-    __version__ = "0.03"
+    __version__ = "0.04"
     __status__ = "testing"
 
     __pattern__ = r'https?://(?:www\.)?cript\.to/folder/(?P<ID>\w+)'
@@ -124,7 +124,7 @@ class CriptTo(SimpleDecrypter):
                     self.log_debug("ReCaptcha captcha found")
 
                     self.captcha = recaptcha
-                    response, challenge = recaptcha.challenge(captcha_key)
+                    response = recaptcha.challenge(captcha_key)
 
                     inputs["g-recaptcha-response"] = response
 
diff --git a/src/pyload/plugins/decrypters/FilecryptCc.py b/src/pyload/plugins/decrypters/FilecryptCc.py
index 791a5fa31..0be3eafe7 100644
--- a/src/pyload/plugins/decrypters/FilecryptCc.py
+++ b/src/pyload/plugins/decrypters/FilecryptCc.py
@@ -25,7 +25,7 @@ from ..base.decrypter import BaseDecrypter
 class FilecryptCc(BaseDecrypter):
     __name__ = "FilecryptCc"
     __type__ = "decrypter"
-    __version__ = "0.44"
+    __version__ = "0.45"
     __status__ = "testing"
 
     __pattern__ = r"https?://(?:www\.)?filecrypt\.cc/Container/\w+"
@@ -261,7 +261,7 @@ class FilecryptCc(BaseDecrypter):
 
         if captcha_key:
             self.captcha = recaptcha
-            response, challenge = recaptcha.challenge(captcha_key)
+            response = recaptcha.challenge(captcha_key)
 
             return self._filecrypt_load_url(
                 url, post={"g-recaptcha-response": response}
diff --git a/src/pyload/plugins/downloaders/FilecloudIo.py b/src/pyload/plugins/downloaders/FilecloudIo.py
index ff20969f3..125e32b1d 100644
--- a/src/pyload/plugins/downloaders/FilecloudIo.py
+++ b/src/pyload/plugins/downloaders/FilecloudIo.py
@@ -9,7 +9,7 @@ from ..base.simple_downloader import SimpleDownloader
 class FilecloudIo(SimpleDownloader):
     __name__ = "FilecloudIo"
     __type__ = "downloader"
-    __version__ = "0.16"
+    __version__ = "0.17"
     __status__ = "testing"
 
     __pattern__ = r"https?://(?:www\.)?(?:filecloud\.io|ifile\.it|mihd\.net)/(?P<ID>\w+)"
@@ -58,7 +58,7 @@ class FilecloudIo(SimpleDownloader):
         self.captcha = ReCaptcha(pyfile)
         captcha_key = self.captcha.detect_key()
         if captcha_key:
-            response, challenge = self.captcha.challenge(captcha_key)
+            response = self.captcha.challenge(captcha_key)
             post_data["r"] = response
 
         self.data = self.load(post_url, post=post_data)
diff --git a/src/pyload/plugins/downloaders/FilefoxCc.py b/src/pyload/plugins/downloaders/FilefoxCc.py
index 6803a132e..0ded81407 100644
--- a/src/pyload/plugins/downloaders/FilefoxCc.py
+++ b/src/pyload/plugins/downloaders/FilefoxCc.py
@@ -14,7 +14,7 @@ from ..helpers import parse_html_tag_attr_value
 class FilefoxCc(XFSDownloader):
     __name__ = "FilefoxCc"
     __type__ = "downloader"
-    __version__ = "0.01"
+    __version__ = "0.02"
     __status__ = "testing"
 
     __pattern__ = r"https?://(?:www\.)?filefox\.cc/(?P<ID>\w{12})"
@@ -59,7 +59,7 @@ class FilefoxCc(XFSDownloader):
             captcha_key = recaptcha.detect_key()
             if captcha_key:
                 self.captcha = recaptcha
-                response, _ = recaptcha.challenge(captcha_key)
+                response = recaptcha.challenge(captcha_key)
 
             else:
                 hcaptcha = HCaptcha(self.pyfile)
diff --git a/src/pyload/plugins/downloaders/FilejokerNet.py b/src/pyload/plugins/downloaders/FilejokerNet.py
index 8a1f462bb..b219beb06 100644
--- a/src/pyload/plugins/downloaders/FilejokerNet.py
+++ b/src/pyload/plugins/downloaders/FilejokerNet.py
@@ -15,7 +15,7 @@ from ..helpers import parse_html_tag_attr_value
 class FilejokerNet(XFSDownloader):
     __name__ = "FilejokerNet"
     __type__ = "downloader"
-    __version__ = "0.11"
+    __version__ = "0.12"
     __status__ = "testing"
 
     __pattern__ = r"https?://(?:www\.)?filejoker\.net/\w{12}"
@@ -67,7 +67,7 @@ class FilejokerNet(XFSDownloader):
             captcha_key = recaptcha.detect_key()
             if captcha_key:
                 self.captcha = recaptcha
-                response, _ = recaptcha.challenge(captcha_key)
+                response = recaptcha.challenge(captcha_key)
 
             else:
                 hcaptcha = HCaptcha(self.pyfile)
diff --git a/src/pyload/plugins/downloaders/FilerNet.py b/src/pyload/plugins/downloaders/FilerNet.py
index 6e6caf060..1b122566d 100644
--- a/src/pyload/plugins/downloaders/FilerNet.py
+++ b/src/pyload/plugins/downloaders/FilerNet.py
@@ -9,7 +9,7 @@ from ..base.simple_downloader import SimpleDownloader
 class FilerNet(SimpleDownloader):
     __name__ = "FilerNet"
     __type__ = "downloader"
-    __version__ = "0.30"
+    __version__ = "0.31"
     __status__ = "testing"
 
     __pattern__ = r"https?://(?:www\.)?filer\.net/get/\w+"
@@ -50,7 +50,7 @@ class FilerNet(SimpleDownloader):
             self.error(self._("Unable to detect hash"))
 
         self.captcha = ReCaptcha(pyfile)
-        response, challenge = self.captcha.challenge()
+        response = self.captcha.challenge()
 
         self.download(
             pyfile.url, post={"g-recaptcha-response": response, "hash": inputs["hash"]}
diff --git a/src/pyload/plugins/downloaders/HitfileNet.py b/src/pyload/plugins/downloaders/HitfileNet.py
index f15985885..bba2feebd 100644
--- a/src/pyload/plugins/downloaders/HitfileNet.py
+++ b/src/pyload/plugins/downloaders/HitfileNet.py
@@ -12,7 +12,7 @@ from ..base.simple_downloader import SimpleDownloader
 class HitfileNet(SimpleDownloader):
     __name__ = "HitfileNet"
     __type__ = "downloader"
-    __version__ = "0.01"
+    __version__ = "0.02"
     __status__ = "testing"
 
     __pattern__ = r"https?://(?:www\.)?(?:hitfile\.net|hil\.to)/(?:download/free/)?(?P<ID>\w+)"
@@ -82,7 +82,7 @@ class HitfileNet(SimpleDownloader):
 
         if inputs["captcha_type"] == "recaptcha2":
             self.captcha = ReCaptcha(self.pyfile)
-            inputs["g-recaptcha-response"], challenge = self.captcha.challenge()
+            inputs["g-recaptcha-response"] = self.captcha.challenge()
             self.captcha.correct()
 
         else:
diff --git a/src/pyload/plugins/downloaders/MediafireCom.py b/src/pyload/plugins/downloaders/MediafireCom.py
index 30414ba2a..d4195d59a 100644
--- a/src/pyload/plugins/downloaders/MediafireCom.py
+++ b/src/pyload/plugins/downloaders/MediafireCom.py
@@ -9,7 +9,7 @@ from ..base.simple_downloader import SimpleDownloader
 class MediafireCom(SimpleDownloader):
     __name__ = "MediafireCom"
     __type__ = "downloader"
-    __version__ = "0.98"
+    __version__ = "0.99"
     __status__ = "testing"
 
     __pattern__ = r"https?://(?:www\.)?mediafire\.com/(file/|view/\??|download(\.php\?|/)|\?)(?P<ID>\w+)"
@@ -66,7 +66,7 @@ class MediafireCom(SimpleDownloader):
 
             if url:
                 self.captcha = recaptcha
-                response, challenge = recaptcha.challenge(captcha_key)
+                response = recaptcha.challenge(captcha_key)
 
                 inputs["g-recaptcha-response"] = response
                 self.data = self.load(self.fixurl(url), post=inputs)
diff --git a/src/pyload/plugins/downloaders/NitroflareCom.py b/src/pyload/plugins/downloaders/NitroflareCom.py
index db5dc744c..44efa3da6 100644
--- a/src/pyload/plugins/downloaders/NitroflareCom.py
+++ b/src/pyload/plugins/downloaders/NitroflareCom.py
@@ -13,7 +13,7 @@ from ..base.simple_downloader import SimpleDownloader
 class NitroflareCom(SimpleDownloader):
     __name__ = "NitroflareCom"
     __type__ = "downloader"
-    __version__ = "0.31"
+    __version__ = "0.32"
     __status__ = "testing"
 
     __pattern__ = r"https?://(?:www\.)?(?:nitro\.download|nitroflare\.com)/view/(?P<ID>[\w^_]+)"
@@ -93,7 +93,7 @@ class NitroflareCom(SimpleDownloader):
         recaptcha_key = recaptcha.detect_key()
         if recaptcha_key:
             self.captcha = recaptcha
-            response, _ = self.captcha.challenge(recaptcha_key)
+            response = self.captcha.challenge(recaptcha_key)
             inputs["g-recaptcha-response"] = response
         else:
             hcaptcha = HCaptcha(pyfile)
diff --git a/src/pyload/plugins/downloaders/RapidgatorNet.py b/src/pyload/plugins/downloaders/RapidgatorNet.py
index 62feeaaf0..0b504a042 100644
--- a/src/pyload/plugins/downloaders/RapidgatorNet.py
+++ b/src/pyload/plugins/downloaders/RapidgatorNet.py
@@ -15,7 +15,7 @@ from ..base.simple_downloader import SimpleDownloader
 class RapidgatorNet(SimpleDownloader):
     __name__ = "RapidgatorNet"
     __type__ = "downloader"
-    __version__ = "0.58"
+    __version__ = "0.59"
     __status__ = "testing"
 
     __pattern__ = r"https?://(?:www\.)?(?:rapidgator\.(?:net|asia|)|rg\.to)/file/(?P<ID>\w+)"
@@ -164,12 +164,12 @@ class RapidgatorNet(SimpleDownloader):
             if not captcha:
                 self.error(self._("Captcha pattern not found"))
 
-            response, challenge = captcha.challenge()
-
             if isinstance(captcha, ReCaptcha):
+                response = captcha.challenge()
                 post_params = {"g-recaptcha-response": response}
 
             elif isinstance(captcha, SolveMedia):
+                response, challenge = captcha.challenge()
                 post_params = {
                     "adcopy_challenge": challenge,
                     "adcopy_response": response,
diff --git a/src/pyload/plugins/downloaders/TurbobitNet.py b/src/pyload/plugins/downloaders/TurbobitNet.py
index 55a5f33ab..70a506967 100644
--- a/src/pyload/plugins/downloaders/TurbobitNet.py
+++ b/src/pyload/plugins/downloaders/TurbobitNet.py
@@ -13,7 +13,7 @@ from ..base.simple_downloader import SimpleDownloader
 class TurbobitNet(SimpleDownloader):
     __name__ = "TurbobitNet"
     __type__ = "downloader"
-    __version__ = "0.41"
+    __version__ = "0.42"
     __status__ = "testing"
 
     __pattern__ = r'https?://(?:(?:www|m)\.)?(?:turbobit\.net|turbo?\.(?:to|cc))/(?:download/free/)?(?P<ID>\w+)'
@@ -100,7 +100,7 @@ class TurbobitNet(SimpleDownloader):
             captcha_key = recaptcha.detect_key()
             if captcha_key:
                 self.captcha = recaptcha
-                response, _ = recaptcha.challenge(captcha_key)
+                response = recaptcha.challenge(captcha_key)
                 inputs["g-recaptcha-response"] = response
 
             else:
diff --git a/src/pyload/plugins/downloaders/UlozTo.py b/src/pyload/plugins/downloaders/UlozTo.py
index 2ea176fdd..6b1609ba0 100644
--- a/src/pyload/plugins/downloaders/UlozTo.py
+++ b/src/pyload/plugins/downloaders/UlozTo.py
@@ -23,7 +23,7 @@ def convert_decimal_prefix(m):
 class UlozTo(SimpleDownloader):
     __name__ = "UlozTo"
     __type__ = "downloader"
-    __version__ = "1.49"
+    __version__ = "1.50"
     __status__ = "testing"
 
     __pattern__ = r"https?://(?:www\.)?(uloz\.to|ulozto\.(cz|sk|net)|bagruj\.cz|zachowajto\.pl|pornfile\.cz)/(?:live/)?(?P<ID>[!\w]+/[^/?]*)"
@@ -203,7 +203,7 @@ class UlozTo(SimpleDownloader):
                     self.error(self._("ReCaptcha key not found"))
 
                 self.captcha = recaptcha
-                response, challenge = recaptcha.challenge(captcha_key)
+                response = recaptcha.challenge(captcha_key)
 
                 inputs['g-recaptcha-response'] = response
 
diff --git a/src/pyload/plugins/downloaders/UploadedTo.py b/src/pyload/plugins/downloaders/UploadedTo.py
index 678cabbc7..0406e10c0 100644
--- a/src/pyload/plugins/downloaders/UploadedTo.py
+++ b/src/pyload/plugins/downloaders/UploadedTo.py
@@ -14,7 +14,7 @@ from ..base.simple_downloader import SimpleDownloader
 class UploadedTo(SimpleDownloader):
     __name__ = "UploadedTo"
     __type__ = "downloader"
-    __version__ = "1.09"
+    __version__ = "1.10"
     __status__ = "testing"
 
     __pattern__ = r"https?://(?:www\.)?(uploaded\.(to|net)|ul\.to)(/file/|/?\?id=|.*?&id=|/)(?P<ID>\w+)"
@@ -96,7 +96,7 @@ class UploadedTo(SimpleDownloader):
         self.data = self.load("http://uploaded.net/js/download.js")
 
         self.captcha = ReCaptcha(pyfile)
-        response, challenge = self.captcha.challenge()
+        response = self.captcha.challenge()
 
         self.data = self.load(
             "http://uploaded.net/io/ticket/captcha/{}".format(
diff --git a/src/pyload/plugins/downloaders/UploadgigCom.py b/src/pyload/plugins/downloaders/UploadgigCom.py
index 7d371ea46..cff83f9de 100644
--- a/src/pyload/plugins/downloaders/UploadgigCom.py
+++ b/src/pyload/plugins/downloaders/UploadgigCom.py
@@ -9,7 +9,7 @@ from ..base.simple_downloader import SimpleDownloader
 class UploadgigCom(SimpleDownloader):
     __name__ = "UploadgigCom"
     __type__ = "downloader"
-    __version__ = "0.07"
+    __version__ = "0.08"
     __status__ = "testing"
 
     __pattern__ = r"https?://(?:www\.)?uploadgig.com/file/download/\w+"
@@ -44,7 +44,7 @@ class UploadgigCom(SimpleDownloader):
             self.error(self._("ReCaptcha key not found"))
 
         self.captcha = recaptcha
-        response, challenge = recaptcha.challenge(captcha_key)
+        response = recaptcha.challenge(captcha_key)
 
         inputs["g-recaptcha-response"] = response
         self.data = self.load(self.fixurl(url),
-- 
2.30.2

