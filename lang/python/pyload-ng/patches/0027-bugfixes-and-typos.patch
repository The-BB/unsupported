From 2cccb6c93865bba68e1734e5ff014250787494d5 Mon Sep 17 00:00:00 2001
From: GammaC0de <gammac0de@users.noreply.github.com>
Date: Wed, 24 Nov 2021 02:01:03 +0200
Subject: [PATCH 27/73] bugfixes and typos

---
 src/pyload/webui/app/themes/modern/templates/captcha.html | 2 +-
 src/pyload/webui/app/themes/modern/templates/js/base.js   | 5 ++++-
 src/pyload/webui/app/themes/pyplex/templates/captcha.html | 2 +-
 src/pyload/webui/app/themes/pyplex/templates/js/base.js   | 6 ++++--
 4 files changed, 10 insertions(+), 5 deletions(-)

diff --git a/src/pyload/webui/app/themes/modern/templates/captcha.html b/src/pyload/webui/app/themes/modern/templates/captcha.html
index ad04aab90..79b2413b7 100644
--- a/src/pyload/webui/app/themes/modern/templates/captcha.html
+++ b/src/pyload/webui/app/themes/modern/templates/captcha.html
@@ -26,7 +26,7 @@
           </div>
           <div id="cap_interactive" style="display: none; text-align: center; padding-bottom: 15px;">
             <div id="cap_iframe_clipping" style="overflow: hidden;">
-              <iframe src="" id="cap_interactive_iframe" sandbox="allow-scripts allow-forms allow-same-origin" style="position: relative; height: 100%; width: 100%; overflow: hidden; border: 0;">
+              <iframe src="" id="cap_interactive_iframe" frameborder="0" scrolling="no" sandbox="allow-scripts allow-forms allow-same-origin" style="position: relative; height: 100%; width: 100%; overflow: hidden; border: 0;">
                 <p>{{_('Your browser does not support iframes.')}}</p>
               </iframe>
             </div>
diff --git a/src/pyload/webui/app/themes/modern/templates/js/base.js b/src/pyload/webui/app/themes/modern/templates/js/base.js
index 327ef6824..ecfdac57a 100644
--- a/src/pyload/webui/app/themes/modern/templates/js/base.js
+++ b/src/pyload/webui/app/themes/modern/templates/js/base.js
@@ -399,6 +399,7 @@ function set_captcha(a) {
             interactiveCaptchaHandlerInstance = new interactiveCaptchaHandler("cap_interactive_iframe", "cap_invisible_loading", submit_interactive_captcha);
         }
         if(params.url !== undefined && params.url.indexOf("http") === 0) {
+            $("#cap_interactive").css("display", "block");
             interactiveCaptchaHandlerInstance.startInteraction(params.url, params);
         }
     }
@@ -427,6 +428,8 @@ function captcha_reset_default() {
     // $("#cap_box #cap_title").text("{{_('No Captchas to read.')}}");
     $("#cap_interactive_iframe").attr("src", "").css({display: "none", top: "", left: ""})
         .parent().css({height: "", width: ""});
+    $("#cap_interactive_loading").css("display", "none");
+    $("#cap_invisible_loading").css("display", "none");
     if(interactiveCaptchaHandlerInstance) {
         interactiveCaptchaHandlerInstance.clearEventlisteners();
         interactiveCaptchaHandlerInstance = null;
@@ -511,7 +514,7 @@ interactiveCaptchaHandler.prototype.windowEventListener = function(e) {
         interactiveHandlerInstance.clearEventlisteners();
 
     } else if(requestMessage.actionCode === interactiveHandlerInstance.actionCodes.activated) {
-        $("#" + interactiveHandlerInstance._loadingid).css("display", "none");
+        $("#" + interactiveHandlerInstance._loadingId).css("display", "none");
         $("#" + interactiveHandlerInstance._iframeId).css("display", "block");
 
     } else if (requestMessage.actionCode === interactiveHandlerInstance.actionCodes.size)  {
diff --git a/src/pyload/webui/app/themes/pyplex/templates/captcha.html b/src/pyload/webui/app/themes/pyplex/templates/captcha.html
index 8f41dd6b8..1607edf71 100644
--- a/src/pyload/webui/app/themes/pyplex/templates/captcha.html
+++ b/src/pyload/webui/app/themes/pyplex/templates/captcha.html
@@ -26,7 +26,7 @@
           </div>
           <div id="cap_interactive" style="display: none; text-align: center; padding-bottom: 15px;">
             <div id="cap_iframe_clipping" style="overflow: hidden;">
-              <iframe src="" id="cap_interactive_iframe" sandbox="allow-scripts allow-forms allow-same-origin" style="position: relative; height: 100%; width: 100%; overflow: hidden; border: 0;">
+              <iframe src="" id="cap_interactive_iframe" frameborder="0" scrolling="no" sandbox="allow-scripts allow-forms allow-same-origin" style="position: relative; height: 100%; width: 100%; overflow: hidden; border: 0;">
                 <p>{{_('Your browser does not support iframes.')}}</p>
               </iframe>
             </div>
diff --git a/src/pyload/webui/app/themes/pyplex/templates/js/base.js b/src/pyload/webui/app/themes/pyplex/templates/js/base.js
index 88376a5aa..02eb7a7f3 100644
--- a/src/pyload/webui/app/themes/pyplex/templates/js/base.js
+++ b/src/pyload/webui/app/themes/pyplex/templates/js/base.js
@@ -419,6 +419,8 @@ function captcha_reset_default() {
     // $("#cap_box #cap_title").text("{{_('No Captchas to read.')}}");
     $("#cap_interactive_iframe").attr("src", "").css({display: "none", top: "", left: ""})
         .parent().css({height: "", width: ""});
+    $("#cap_interactive_loading").css("display", "none");
+    $("#cap_invisible_loading").css("display", "none");
     if(interactiveCaptchaHandlerInstance) {
         interactiveCaptchaHandlerInstance.clearEventlisteners();
         interactiveCaptchaHandlerInstance = null;
@@ -460,7 +462,7 @@ function submit_interactive_captcha(c) {
 
 function interactiveCaptchaHandler(iframeId, loadingid, captchaResponseCallback) {
     this._iframeId = iframeId;
-    this._loadingid = loadingid;
+    this._loadingId = loadingid;
     this._captchaResponseCallback = captchaResponseCallback;
     this._active = false; // true: link grabbing is running, false: standby
 
@@ -503,7 +505,7 @@ interactiveCaptchaHandler.prototype.windowEventListener = function(e) {
         interactiveHandlerInstance.clearEventlisteners();
 
     } else if(requestMessage.actionCode === interactiveHandlerInstance.actionCodes.activated) {
-        $("#" + interactiveHandlerInstance._loadingid).css("display", "none");
+        $("#" + interactiveHandlerInstance._loadingId).css("display", "none");
         $("#" + interactiveHandlerInstance._iframeId).css("display", "block");
 
     } else if (requestMessage.actionCode === interactiveHandlerInstance.actionCodes.size)  {
-- 
2.30.2

