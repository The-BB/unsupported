From b2db1945a228f94fc5ab78a58005c83e2b6ef2e4 Mon Sep 17 00:00:00 2001
From: GammaC0de <gammac0de@users.noreply.github.com>
Date: Wed, 19 May 2021 01:45:21 +0300
Subject: [PATCH 059/150] fix unicode-escape decoding

---
 src/pyload/core/utils/web/format.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

--- a/src/pyload/core/utils/web/format.py
+++ b/src/pyload/core/utils/web/format.py
@@ -7,14 +7,14 @@ from ..convert import to_str
 from . import purge
 
 _RE_DOUBLE_SLASH = re.compile(r"(?<!:)/{2,}")
-_RE_UNICODE_ESCAPE = re.compile(r"\\[uU](\d{4})")
+_RE_UNICODE_ESCAPE = re.compile(r"\\[uU]([\da-fA-F]{4})")
 
 
 def url(value):
     url = urllib.parse.unquote(to_str(value))
 
     #: Translate 'unicode-escape' escapes
-    url = re.sub(_RE_UNICODE_ESCAPE, lambda x: chr(int(x.group(1))), url)
+    url = re.sub(_RE_UNICODE_ESCAPE, lambda x: chr(int(x.group(1), 16)), url)
 
     #: Removes HTML tags and translate HTML escape characters
     url = purge.text(url)
